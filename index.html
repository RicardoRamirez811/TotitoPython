<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Totito / Gato en Python (PyScript)</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- PyScript -->
 <!-- <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
  <script defer src="https://pyscript.net/latest/pyscript.js"></script> -->
<link rel="stylesheet" href="https://pyscript.net/releases/2024.1.1/core.css">
<script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>

</head>

<body class="bg-light">
  <div class="container py-4">
    <div class="row justify-content-center">
      <div class="col-12 col-md-10 col-lg-8">

        <div class="card shadow-sm">
          <div class="card-body">

            <div class="d-flex flex-wrap gap-2 align-items-center justify-content-between mb-3">
              <div>
                <h3 class="mb-0">Totito / Gato</h3>
                <small class="text-muted">Python (PyScript) — Línea en 3</small>
              </div>

              <div class="d-flex flex-wrap gap-2 align-items-center">
                <select id="selectModo" class="form-select form-select-sm" style="width: 170px;">
                  <option value="unica">Partida única</option>
                  <option value="mejorDe3">Mejor de 3</option>
                </select>

                <select id="selectRival" class="form-select form-select-sm" style="width: 190px;">
                  <option value="jugador">Jugador vs Jugador</option>
                  <option value="cpu">Jugador vs CPU</option>
                </select>

                <select id="selectDificultad" class="form-select form-select-sm" style="width: 190px;" disabled>
                  <option value="facil">CPU Fácil</option>
                  <option value="medio">CPU Medio</option>
                  <option value="dificil">CPU Difícil (Minimax)</option>
                </select>

                <button id="btnIniciar" class="btn btn-sm btn-success">Iniciar</button>
              </div>
            </div>

            <!-- Nombres -->
            <div class="row g-2 mb-3">
              <div class="col-12 col-md-6">
                <label class="form-label mb-1">Nombre Jugador 1 (X)</label>
                <input id="inputNombreX" class="form-control" value="Jugador 1">
              </div>
              <div class="col-12 col-md-6">
                <label class="form-label mb-1">Nombre Jugador 2 (O)</label>
                <input id="inputNombreO" class="form-control" value="Jugador 2">
                <div class="form-text" id="textoAyudaO">En CPU, este será el nombre de la máquina.</div>
              </div>
            </div>

            <!-- Marcador / Estado -->
            <div class="row g-2 mb-3">
              <div class="col-12 col-md-6">
                <div class="p-3 rounded bg-white border">
                  <div class="d-flex justify-content-between">
                    <span id="etiquetaX">Jugador 1 (X)</span>
                    <strong id="marcadorX">0</strong>
                  </div>
                  <div class="d-flex justify-content-between">
                    <span id="etiquetaO">Jugador 2 (O)</span>
                    <strong id="marcadorO">0</strong>
                  </div>
                  <hr class="my-2">
                  <div class="d-flex justify-content-between">
                    <span>Ronda</span>
                    <strong id="etiquetaRonda">-</strong>
                  </div>
                </div>
              </div>

              <div class="col-12 col-md-6">
                <div class="p-3 rounded bg-white border h-100">
                  <div class="d-flex justify-content-between align-items-start">
                    <div>
                      <div class="text-muted small mb-1">Estado</div>
                      <div id="textoEstado" class="fw-semibold">Configura y presiona “Iniciar”.</div>
                    </div>
                    <span id="insigniaTurno" class="badge text-bg-secondary">Sin iniciar</span>
                  </div>
                  <div class="text-muted small mt-2">
                    “Finalizar (me rindo)” declara perdedor al jugador del turno.
                  </div>
                </div>
              </div>
            </div>

            <!-- Tablero + Overlay -->
            <div class="position-relative bg-white border rounded p-3">
              <div class="row g-2" id="tablero"></div>

              <div
                id="overlaySerieFinalizada"
                class="position-absolute top-0 start-0 w-100 h-100 d-none align-items-center justify-content-center"
                style="background: rgba(255,255,255,.85); backdrop-filter: blur(2px); border-radius: .375rem;"
              >
                <div class="text-center p-3">
                  <div class="badge text-bg-dark mb-2 px-3 py-2" style="font-size: 1rem;">
                    Serie finalizada
                  </div>
                  <div class="fw-semibold mb-3">
                    Presiona “Nueva serie” para volver a jugar.
                  </div>
                  <button id="btnOverlayNuevaSerie" class="btn btn-dark">Nueva serie</button>
                </div>
              </div>
            </div>

            <!-- Controles -->
            <div class="d-flex flex-wrap gap-2 mt-3">
              <button id="btnReiniciarRonda" class="btn btn-outline-primary" disabled>Reiniciar ronda</button>
              <button id="btnRendirse" class="btn btn-outline-danger" disabled>Finalizar (me rindo)</button>
              <button id="btnNuevaSerie" class="btn btn-secondary ms-auto" disabled>Nueva serie</button>
            </div>

            <!-- Confirmación -->
            <div class="alert alert-warning mt-3 mb-0 d-none" id="cajaConfirmacion" role="alert">
              <div class="d-flex flex-wrap gap-2 align-items-center justify-content-between">
                <div id="textoConfirmacion" class="me-2">¿Confirmas?</div>
                <div class="d-flex gap-2">
                  <button id="btnConfirmarSi" class="btn btn-sm btn-danger">Sí</button>
                  <button id="btnConfirmarNo" class="btn btn-sm btn-outline-secondary">No</button>
                </div>
              </div>
            </div>

            <!-- Historial -->
            <div class="mt-3">
              <h6 class="mb-2">Historial de rondas</h6>
              <ul id="listaHistorial" class="list-group small">
                <li class="list-group-item text-muted">Aún no hay rondas registradas.</li>
              </ul>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>


<py-config>
{
  "files": {
    "./Python/app_controller.py": "app_controller.py",
    "./Python/setup.py": "setup.py",
    "./Python/ui_render.py": "ui_render.py",
    "./Python/dom_utils.py": "dom_utils.py",
    "./Python/confirm.py": "confirm.py",
    "./Python/game_flow.py": "game_flow.py",
    "./Python/ai.py": "ai.py",
    "./Python/proxies.py": "proxies.py",
    "./Python/rules.py": "rules.py",
    "./Python/state.py": "state.py",
    "./Python/main.py": "main.py"
  }
}
</py-config>

<py-script src="Python/main.py"></py-script>
</body>
</html>